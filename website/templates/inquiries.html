{% extends 'base.html' %}


{% block content %}

	<!DOCTYPE html>
		<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Fontfaces CSS-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">          
		<link href ="{{url_for('static', filename = 'css/bootstrap-strategies.css')}}" rel = "stylesheet"/>
        <link href="{{ url_for('static',  filename='css/theme.css') }}" rel="stylesheet">
        
        <!-- Sort/Search Table CSS -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">

        <!-- Export -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
        <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.0.1/css/buttons.dataTables.min.css">
        
		{% block title %} Stratics Admin | Inquiries {% endblock %}
		
		</head>
		<body>
		
		<div class="strat-container-main">
			<h3>Inquiries</b></h3>
			<div class="strat-stat-container">
				<div class="strat-row">
					<div class="strat-column-head">
					<div class="strat-card-head">
						<h4>Inquiries</h4>
						<p class='card-strat-large primary'>{{ contacts|length }}</p>
					</div>
					</div>
				</div>
			</div>
		</div>            
		
            {% with messages = get_flashed_messages(with_categories = true) %} 
            {% if messages %} 
            {% for category, message in messages %}

			{% if category == "limit" %}
			<div class="alert alert-primary alert-dismissable" role="alert"> 
                <button type="button" class="close" data-dismiss="alert"> 
                    &nbsp; <i class="zmdi zmdi-close"></i><br>
                </button>            

            {{message}}
            </div>
			{% else %}
			
            <div class="alert alert-success alert-dismissable" role="alert"> 
                <button type="button" class="close" data-dismiss="alert"> 
                    &nbsp; <i class="zmdi zmdi-close"></i><br>
                </button>            

            {{message}}
            </div>
			
			{% endif %}
			
            {% endfor %}
            {% endif %}
            {% endwith %}
			
    <div class="row">
            <div class="table-responsive table-responsive-data2">
			<form action="/inquiries/delete-selected" method="POST">
                <table class="table table-data2" id="mytable">
                    <thead>
                        <tr>
                            <th>
                                <label class="au-checkbox">
                                    <input type="checkbox" id="checkall">
                                    <span class="au-checkmark"></span>
                                </label>
                            </th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Message</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in contacts %}
                        <tr class="tr-shadow">
                            <td>
                                <label class="au-checkbox">
                                    <input type="checkbox" name="mycheckbox" class="checkthis" value="{{row.id}}">
                                    <span class="au-checkmark"></span>
                                </label>
                            </td>
							<td>{{row.name}}</td>
							<td>{{row.email}}</td>
							<td>{{row.message}}</td>
							<td>
                                <div class="table-data-feature">
                                    <a href="/inquiries/send-email/{{row.id}}" class="item" data-toggle="modal" data-toggle="tooltip" data-placement="top" title="Send" data-target="#modalsend{{row.id}}"><button id = "send"><i class="zmdi zmdi-mail-send"></i></button></a>
                                    <a href="/inquiries/delete/{{row.id}}" class="item" data-toggle="modal" data-toggle="tooltip" data-placement="top" title="Delete" data-target="#modaldelete{{row.id}}"><button id = "delete"><i class="zmdi zmdi-delete"></i></button></a>
                                </div>
                            </td>
                        </tr>
			</form>
                   
					 <!-- Modal Delete Inquiry-->

					    <div id="modaldelete{{row.id}}" class="modal fade">
						<div class="modal-dialog modal-dialog-centered">
						    <div class="modal-content">
								<div class="modal-header">   
									<h4 class="modal-title">Delete Inquiry</h4>
								</div>
								<div class="modal-body">
									<form action="/inquiries/delete/{{row.id}}">
										<div class="form-group">
											<label>Are you sure you want to delete Inquiry?</label>
										</div>  
										<div class="modal-footer">
											<button class="btn btn-primary" type="submit">Delete Inquiry</button>
											<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
										</div>
									</form>
								</div>    
                            				</div>
						</div> 
					</div>	
<div id="modalsend{{row.id}}" class="modal fade" role="dialog">
                      <div class="modal-dialog">
                          <div class="modal-content">
                              <div class="modal-header"> 
                                  <h4 class="modal-title">New Message</h4>
                              </div>   
                              <div class="modal-body"> 
                                <form action="/inquiries/send-email/{{row.id}}" method="POST" enctype="multipart/form-data">
                                  <div class="form-inline"> 
                                      <label>To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                                      <input type="text" class="form-control" name="email" required="1" value="{{ row.email }}"> 
                                  </div> 
                                  <div class="form-inline"> 
				  <label>Subject:&nbsp;</label>
                                      <input type="text" class="form-control" name="subject" required="1" placeholder="Subject"> 
                                  </div>
				  <div class="form-inline"> 
                                  </div> 
                                  <div class="form-group"> 
                                      <textarea class="input-field" class="form-control" name="message" id="message" placeholder="Enter Message"></textarea>
                                  </div> 
				<div class="modal-footer">
				<button class="btn btn-primary" type="submit">Send</button>
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			</div>
                                </form> 
                              </div> 
                          </div>     
                        </div> 
                    </div> 
	</div>
                        {% endfor %}
                    </tbody>
			<div class="col-md-12">
				<div class="table-data__tool-right" style="padding-bottom:15px;margin-top: 0.20rem;margin-left: -1rem;">
					<button type="submit" class="au-btn au-btn-icon au-btn--red au-btn--small" style="width: 40px; font-size: 14px;color:white;padding: -1 0;">
					<i class="bx bx-trash" style="margin-left: 5px;"></i>Delete</button>
				</div>
			</div>
                </table>
			</form>
		</div>
	</div>
	
		  <script type = "text/javascript" src ="{{url_for('static', filename = 'js/jquery-3.2.1.min.js')}}"></script>
		  <script type = "text/javascript" src ="{{url_for('static', filename = 'js/bootstrap.js')}}"></script>
		  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
		  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
		  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script> 
          <script type = "text/javascript" src ="{{url_for('static', filename = 'js/tables.js')}}"></script>
        
        <!-- Sort/Search Table JS -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>

        <!-- Export JS -->
        <script src="https://code.jquery.com/jquery-3.5.1.js"></script></script>
        <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.0.1/js/dataTables.buttons.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.html5.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.print.min.js"></script>

        <script type="text/javascript">
            $(document).ready(function() 
            { 
                $('#mytable').DataTable( 
                {             
                    "lengthMenu": [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]],
                    dom: 'B<"clear">lfrtip',
                    buttons: [    
                        {
                            extend: 'excelHtml5',
                            title: 'Stratics',
                            text: 'Export',
                            split: [ 'pdf', 'excel', 'csv'],
                        },  
                   ]	        
                });
                
                $('.btn_pdf').attr("class","btn btn-success");        
            } );
            </script>
		
		<script>
			$(document).ready(function(){
			$("#mytable #checkall").click(function () {
					if ($("#mytable #checkall").is(':checked')) {
						$("#mytable input[type=checkbox]").each(function () {
							$(this).prop("checked", true);
						});
			 
					} else {
						$("#mytable input[type=checkbox]").each(function () {
							$(this).prop("checked", false);
						});
					}
				});
				 
				$("[data-toggle=tooltip]").tooltip();
			});
			 
		</script>
        </body>
	</html>

{% endblock %}
